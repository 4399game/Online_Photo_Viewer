{% extends 'base/base_extra.html' %}
{% load staticfiles %}
{% block vcr_css %}
    <link rel="stylesheet" href="{% static 'plugin/viewer/viewer.min.css' %}">
{% endblock vcr_css %}
{% block center %}
<div class="ui container">
    <div class="ui top fixed menu s" id="choise_bar">
        <a class="item">
            <i class="sidebar icon"></i>
            <p class="">菜单</p>
        </a>
        <a class="item right floated">个性化</a>
    </div>
    <i class="fr" style="font-size: 18px;">&times;</i>
    <div class="ui stackable relaxed grid" style="margin-top: 60px;">
        <div class="ui four wide column computer only">
            <div class="ui secondary vertical fluid pointing menu">
                <a class="active item" onclick="go_in_s('style', null)">
                    个性化
                </a>
                <a class="item" onclick="go_in_s('safe', null)">
                    安全性
                </a>
                <a class="item" onclick="go_in_s('setting', null)">
                    设置
                </a>
            </div>
        </div>
        <div class="ui twelve wide column">
            {% block main_thing %}
            <div class="ui large header">
                网站名称
                <a class="txt-mini the_name" style="padding-left: 15px;">（{{ style.name }}）</a>
                <div class="sub header">自定义网站名称，VcrT对此具有开放性：</div>
            </div>
            <a class="underline txt-mini change_name">点此更换</a>
            <br/>
            <br/>
            <div class="ui large header">
                首页背景
                <a class="txt-mini the_bg_img" style="padding-left: 15px;">（预览）</a>
                <div class="sub header">选择合适的首页背景图片，百变青英：</div>
            </div>
            <a class="underline txt-mini change_bg_img">点此更换</a>
            <br/>
            <br/>
            <!--
            <div class="ui large header">
                主题颜色
                <a class="txt-small">&nbsp;</a>
                <a class="ui {{ style.main_color }} circular label" id="show_main_color"></a>
                <div class="sub header">根据喜好选择网站的主题颜色：</div>
            </div>
            <div class="ui horizontal list" id="main_color_list"  style="background: rgba(253, 253, 253, 1);padding: 7px 15px 0px 15px;">
                <a class="item">
                    <div class="ui red circular label"></div>
                </a>
                <a class="item">
                    <div class="ui orange circular label"></div>
                </a>
                <a class="item">
                    <div class="ui yellow circular label"></div>
                </a>
                <a class="item">
                    <div class="ui olive circular label"></div>
                </a>
                <a class="item">
                    <div class="ui teal circular label"></div>
                </a>
                <a class="item">
                    <div class="ui blue circular label"></div>
                </a>
                <a class="active item">
                    <div class="ui violet circular label"></div>
                </a>
                <a class="item">
                    <div class="ui purple circular label"></div>
                </a>
                <a class="item">
                    <div class="ui pink circular label"></div>
                </a>
                <a class="item">
                    <div class="ui brown circular label"></div>
                </a>
                <a class="item">
                    <div class="ui black circular label"></div>
                </a>
                <a class="item">
                    <div class="ui grey circular label"></div>
                </a>
            </div>
            <br/>
            <br/>
            <div class="ui large header">
                附加颜色<a class="txt-small">&nbsp;</a>
                <a class="ui circular label" style="background: {{ request.session.kouza_.style.diy_color }}1);"></a>
                <div class="sub header">选择附加颜色能让页面更美观：</div>
                <style>
                    .fen{       background: rgba(255, 174, 200, 1);     }
                    .lan{       background: rgba(0, 168, 243, 1);       }
                    .huang{     background: rgba(255, 242, 0, 1);       }
                    .lv{        background: rgba(14, 209, 69, 1);       }
                    .hong{      background: rgba(236, 28, 36, 1);       }
                    .shuilv{    background: rgba(140, 255, 251, 1);     }
                    .jin{       background: rgba(255, 202, 24, 1);      }
                    .qianlv{    background: rgba(196, 255, 14, 1);      }
                    .cheng{     background: rgba(255, 127, 39, 1);         }
                    .dianlan{   background: rgba(63, 72, 204, 1);       }
                    .he{        background: rgba(185, 122, 86, 1);      }
                    .qianhuang{ background: rgba(253, 236, 166, 1);     }
                    .shenghong{ background: rgba(136, 0, 27, 1);        }
                    .zise{      background: rgba(184, 61, 186, 1);      }
                    .hui{       background: rgba(88, 88, 88, 1);        }
                    .qianhui{   background: rgba(195, 195, 195, 1);     }
                </style>
            </div>
            <div class="ui horizontal list" style="background: rgba(253, 253, 253, 1);padding: 7px 15px 0px 15px;">
                <a class="item">
                    <i class="ui circular label" style="background: rgba(255, 174, 200, 1);"></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(0, 168, 243, 1);"></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(255, 242, 0, 1);"></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(14, 209, 69, 1); "></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(236, 28, 36, 1); "></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(140, 255, 251, 1); "></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(255, 202, 24, 1);"></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(196, 255, 14, 1); "></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(255, 127, 39, 1); "></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(63, 72, 204, 1); "></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(185, 122, 86, 1); "></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(253, 236, 166, 1); "></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(136, 0, 27, 1); "></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(184, 61, 186, 1); "></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(88, 88, 88, 1); "></i>
                </a>
                <a class="item">
                    <i class="ui circular label" style="background: rgba(195, 195, 195, 1); "></i>
                </a>
            </div>
        </div>-->
            <!-- 填写网站名称 -->
            <div class="ui mini basic modal" id="name_modal">
                <div class="content">
                    <div class="ui search">
                        <div class="ui fluid input">
                            <input class="prompt" id='name_input' type="text" placeholder="{{ style.name }}">
                            <input id='name_hidden' type="hidden" value="{{ style.name }}">
                        </div>
                        <div class="results"></div>
                    </div>
                    <button class="ui twitter button fr" id="name_approve" style="margin-top: 15px;">
                        <i class="ui checkmark icon"></i>
                        ok
                    </button>
                </div>
            </div>
            <!-- 网站背景 -->
            <div class="ui fullscreen basic modal" id="bg_img_modal" 
                style="padding: 0 0 0 0; position: relative;">
                <iframe src="http://127.0.0.1:8000/" style="width: 100%; overflow: hidden;" id="index_iframe">
                </iframe>
                <div class="frame_hui" id="frame_hui"></div>
            </div>
            <input type="file" id="bg_img_hidden" style="display: none;" onchange="change_bg_img();">
            <img id="show_bg_img" src="" data-original="" style="display: none;">
            {% endblock main_thing %}
        </div>
        <div class="ui two wide column"></div>
    </div>
</div>
{% endblock center %}
{% block vcr_js %}
<script type="text/javascript">
    var data = {
        'name': '{{ style.name }}',
        'main_color': '{{ style.main_color }}',
        'diy_color': '{{ style.diy_color }}',
        'bg_img': '{{ MEDIA_URL }}{{ style.bg_img }}'
    };
    var ratio = window.w / window.h;
    // name
    $('.change_name').click(function() {
        $('#name_modal').modal('show');
    });
    $('#name_approve').click(function() {
        $('.modal').modal('hide');
        var the_name = $('#name_input').val();
        $('.the_name').html(
            '（' + the_name + '）'
        );
        $('#name_hidden').val(the_name);
        data['name'] = the_name;
    });

    // bg_img
    $('.the_bg_img').click(function() {
        $('#bg_img_modal').modal('show');
        $('#index_iframe').height($('#bg_img_modal').width() / ratio);
        $('#frame_hui').offset($('#index_iframe').offset());
    });
    $('#frame_hui').click(function() {
        $('.modal').modal('hide');
    });
    $('.change_bg_img').click(function() {
        $('#bg_img_hidden').click();
    });
    function change_bg_img(){
    }
    submit_style = function (data) {
        $.ajax({
            url: ajax_style_url,
            data: data,
            type: 'PUT',
            cache: false,
            beforeSend:function(xhr, settings){
                xhr.setRequestHeader("X-CSRFToken", $("input[name='csrfmiddlewaretoken']").val() );
            },
            success: function (callback) {
                if ((callback != 'False') | (callback != false)) {
                    console.info(callback);
                }
                else{
                    open_tishi_modal('Edit failed !!!')
                }
            },
            error: function (callback) {
                open_tishi_modal('Server error ......')
            }

        });
    }
</script>
<script type="text/javascript" src="{% static 'plugin/viewer/viewer.min.js' %}"></script>
{% endblock vcr_js %}